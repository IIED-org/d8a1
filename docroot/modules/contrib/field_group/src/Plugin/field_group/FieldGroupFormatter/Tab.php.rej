***************
*** 27,39 ****
    /**
     * {@inheritdoc}
     */
-   public function preRender(&$element, $rendering_object) {
-     parent::preRender($element, $rendering_object);
  
      $add = [
        '#type' => 'details',
        '#title' => Html::escape($this->t($this->getLabel())),
        '#description' => $this->getSetting('description'),
      ];
  
      if ($this->getSetting('id')) {
--- 27,42 ----
    /**
     * {@inheritdoc}
     */
+   public function process(&$element, $processed_object) {
+ 
+     // Keep using preRender parent for BC.
+     parent::preRender($element, $processed_object);
  
      $add = [
        '#type' => 'details',
        '#title' => Html::escape($this->t($this->getLabel())),
        '#description' => $this->getSetting('description'),
+       '#group' => $this->group->parent_name,
      ];
  
      if ($this->getSetting('id')) {
***************
*** 54,66 ****
        $element['#open'] = TRUE;
      }
  
-     // Front-end and back-end on configuration will lead
-     // to vertical tabs nested in a separate vertical group.
-     if (!empty($this->group->parent_name)) {
-       $add['#group'] = $this->group->parent_name;
-       $add['#parents'] = [$add['#group']];
-     }
- 
      if ($this->getSetting('required_fields')) {
        $element['#attached']['library'][] = 'field_group/formatter.tabs';
        $element['#attached']['library'][] = 'field_group/core';
--- 57,62 ----
        $element['#open'] = TRUE;
      }
  
      if ($this->getSetting('required_fields')) {
        $element['#attached']['library'][] = 'field_group/formatter.tabs';
        $element['#attached']['library'][] = 'field_group/core';
***************
*** 70,75 ****
  
    }
  
    /**
     * {@inheritdoc}
     */
--- 66,79 ----
  
    }
  
+   /**
+    * {@inheritdoc}
+    */
+   public function preRender(&$element, $rendering_object) {
+     parent::preRender($element, $rendering_object);
+     $this->process($element, $rendering_object);
+   }
+ 
    /**
     * {@inheritdoc}
     */
