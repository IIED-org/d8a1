***************
*** 584,590 ****
    // still want to be able to show/hide them. Since there's no actual HTML input
    // element available, setting #attributes does not make sense, but a wrapper
    // is available, so setting #wrapper_attributes makes it work.
-   $key = ($elements['#type'] == 'item') ? '#wrapper_attributes' : '#attributes';
    $elements[$key]['data-drupal-states'] = Json::encode($elements['#states']);
  }
  
--- 584,590 ----
    // still want to be able to show/hide them. Since there's no actual HTML input
    // element available, setting #attributes does not make sense, but a wrapper
    // is available, so setting #wrapper_attributes makes it work.
+   $key = (isset($elements['#type']) && $elements['#type'] == 'item') ? '#wrapper_attributes' : '#attributes';
    $elements[$key]['data-drupal-states'] = Json::encode($elements['#states']);
  }
  
